<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>NSAP Scheme Predictor</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Remove number input spinners cross-browser -->
  <style>
    input[type=number] {
      appearance: textfield;
      -moz-appearance: textfield;
      -webkit-appearance: none;
    }
    input::-webkit-inner-spin-button,
    input::-webkit-outer-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-blue-100 to-blue-300 font-sans min-h-screen">

  <!-- Landing Page Section -->
  <section class="min-h-screen flex flex-col items-center justify-center text-center px-4">
    <p class="text-sm text-red-700 bg-red-100 px-4 py-2 rounded mb-4 border border-red-300 max-w-xl">
      ‚ö†Ô∏è <strong>Disclaimer:</strong> The machine learning model is currently not serving predictions due to excessive consumption of Cloud Hosted Units (CHUs) on IBM Cloud. Please use the sample dataset and UI flow for demonstration purposes only.
    </p>

    <h2 class="text-4xl md:text-5xl font-bold text-blue-800 mb-4">NSAP Scheme Predictor</h2>
    <p class="text-lg text-gray-700 max-w-xl mb-4">
      This AI-powered tool assists government agencies in quickly identifying the most suitable social welfare scheme
      for an applicant based on their demographic and regional data.
    </p>

    <a href="NSAP_sample.csv" download
       class="mb-4 inline-block bg-green-600 hover:bg-green-700 text-white px-5 py-2 rounded shadow transition">
      üì• Download Sample Dataset
    </a>
    <p class="text-sm text-gray-600 mb-6">Use this dataset for reference before submitting input.</p>

    <button onclick="document.getElementById('formSection').scrollIntoView({ behavior: 'smooth' })"
            class="bg-blue-700 hover:bg-blue-800 text-white px-6 py-3 rounded-lg shadow-lg transition">
      üöÄ Start Prediction
    </button>
  </section>

  <!-- Prediction Form Section -->
  <section id="formSection" class="py-12 px-4 flex items-center justify-center bg-blue-50">
    <div class="w-full max-w-3xl bg-white shadow-xl rounded-xl p-8">
      <h2 class="text-2xl font-bold text-center mb-6 text-blue-700">Enter Applicant Details</h2>
      
      <form id="predictionForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <input name="finyear" placeholder="Year (e.g. 2023)" required class="input-style" />
        <input name="lgdstatecode" type="number" placeholder="State Code" required class="input-style" />
        <input name="statename" placeholder="State Name" required class="input-style" />
        <input name="lgddistrictcode" type="number" placeholder="District Code" required class="input-style" />
        <input name="districtname" placeholder="District Name" required class="input-style" />
        <input name="totalbeneficiaries" type="number" placeholder="Total Beneficiaries" required class="input-style" />
        <input name="totalmale" type="number" placeholder="Total Male" required class="input-style" />
        <input name="totalfemale" type="number" placeholder="Total Female" required class="input-style" />
        <input name="totaltransgender" type="number" placeholder="Total Transgender" required class="input-style" />
        <input name="totalsc" type="number" placeholder="Total SC" required class="input-style" />
        <input name="totalst" type="number" placeholder="Total ST" required class="input-style" />
        <input name="totalgen" type="number" placeholder="Total General" required class="input-style" />
        <input name="totalobc" type="number" placeholder="Total OBC" required class="input-style" />
        <input name="totalaadhaar" type="number" placeholder="Total Aadhaar" required class="input-style" />
        <input name="totalmobilenumber" type="number" placeholder="Total Mobile" required class="input-style" />

        <button type="submit"
                class="col-span-1 md:col-span-2 bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded transition mt-2">
          üîç Predict
        </button>
      </form>

      <div id="result" class="mt-6 text-center text-lg font-semibold text-green-700"></div>
    </div>
  </section>

  <script>
    document.getElementById("predictionForm").onsubmit = async function (e) {
      e.preventDefault();

      const formData = new FormData(e.target);
      const payload = {};

      for (const [key, value] of formData.entries()) {
        payload[key] = isNaN(value) ? value : Number(value);
      }

      document.getElementById("result").textContent = "üîÑ Predicting...";

      try {
        const response = await fetch("http://127.0.0.1:5000/predict", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(payload)
        });

        const result = await response.json();

        document.getElementById("result").textContent =
          result.prediction
            ? "‚úÖ Predicted Scheme Code: " + result.prediction
            : "‚ùå Error: " + (result.error || "Unknown error");

      } catch (err) {
        console.error("Fetch error:", err);
        document.getElementById("result").textContent = "‚ùå Could not reach the server.";
      }
    };
  </script>

  <style>
    .input-style {
      width: 100%;
      padding: 0.5rem 0.75rem;
      border: 1px solid #ccc;
      border-radius: 0.375rem;
      outline: none;
      transition: box-shadow 0.3s ease;
    }
    .input-style:focus {
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.5);
    }
  </style>
</body>
</html>
